<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />









  <link rel="alternate" href="/atom.xml" title="SNH48 Live Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.4.x" />



<link rel="canonical" href="https://blog.snh48live.org/"/>


<meta property="og:type" content="website">
<meta property="og:title" content="SNH48 Live Blog">
<meta property="og:url" content="https://blog.snh48live.org/index.html">
<meta property="og:site_name" content="SNH48 Live Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SNH48 Live Blog">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.4.x" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  



    <title> SNH48 Live Blog </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <img class="logo" src="/img/logo-mobile.png" srcset="/img/logo-mobile@2x.png 2x, /img/logo-mobile@3x.png 3x" alt="logo">
    <a href="/." class="logo-text">SNH48 Live Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="https://youtube.com/SNH48Live">
        <li class="mobile-menu-item">
          
          
            YouTube
          
        </li>
      </a>
    
      <a href="https://snh48live.org">
        <li class="mobile-menu-item">
          
          
            SNH48Live.org
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <img class="logo" src="/img/logo.png" srcset="/img/logo@2x.png 2x, /img/logo@3x.png 3x" alt="logo">
  <a href="/." class="logo-text">SNH48 Live Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              Archives
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="https://youtube.com/SNH48Live">
            
            
              YouTube
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="https://snh48live.org">
            
            
              SNH48Live.org
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  <section id="posts" class="posts">
    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/08/01/精华/">目标：整合村内最精华的内容</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Aug 1, 2017
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>转发一下<a href="https://www.youtube.com/watch?v=Q7W0IdBbXFE&amp;lc=z23hwfvxhwfafhpu5acdp431kic3bomwgjoclaqjlzhw03c010c" target="_blank" rel="external">自己的一条评论</a>：</p>
<blockquote>
<p>隔了三天才发剪出的单曲，可以说又后知后觉了。其实总共只花了几十分钟的工作，我来谈下为什么拖到现在吧。</p>
<p>自设立这个频道起，我就一直在考虑一个问题：究竟什么内容适合这个频道？我的初衷自然是上传公演，但做了一段时间之后，我认为这个频道是一个良好的平台，不妨做得更广一点，囊括更多的内容，把它打造成一扇了解SNH48的窗户。于是我加入了《Lucky Seven Baby》、《莫莫有闻》等团综、纪录片以及一些音乐内容。然而新增内容有一个度的问题。比如，既然我上传了《莫莫有闻》（暂且撇开我推莫寒的私心），我是不是应该一视同仁地上传《塞纳河一周播报》、《塞纳河周边研发社》等小节目？上传的小节目、小视频过多自然会稀释频道的核心——公演，使频道的可订阅性下降——我个人不喜欢订阅更新非常频繁的频道，因为会有目不暇接的感觉。这自然不是对其他频道的批判——我尊重也感激其他无差别上传小视频的频道，我们共同组成了对SNH48最完整的覆盖（请容我把自己算进去）；只是我有我自己的取舍，想做一个更具统一性的频道而已——我的这方面追求从我的视频封面就可见一斑。我想，我目前的目标简单来说就是整合“村内”最精华的内容；而究竟什么是最精华的内容，究竟哪里是数量和质量的平衡点，这些都比较主观，都是我在摸索的。</p>
<p>回到这次剪出的二十一首单曲。本来没这个打算，但后来考虑到自己看了很多遍莫寒的《梦》（演唱会当时我就私下剪出来了），意识到每一首单曲对不同人群有不同的收藏价值；完整的演唱会虽好，但能直接回顾最喜欢的单曲，有别样的意义。这次，数量之庞大并不能掩盖质量之光华。</p>
</blockquote>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/07/30/记一次失败的转播/">记一次失败的转播</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 30, 2017
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>众所周知我推莫寒。关于结果并没有什么可说的；江东子弟多才俊，卷土重来未可知，聊以自慰。不论成绩如何，S队还是S队，莫寒还是莫寒，八月五日依旧会开开心心地看公演。</p>
<p>这篇博文我只想记录我转播总选时的一些教训，以供将来借鉴。进入技术话题，切换至英文模式。</p>
<hr>
<p>So, yesterday I streamed the official YouTube broadcast onto my very own livestream. The motivation was to have a readily available backup VOD immediately after the event, in case the official channel did anything stupid to their version. Turns out this went horribly wrong. The official channel didn’t do anything stupid to their archived stream, and the last four hours were immediately available after the broadcast; some hours later, processing on the <a href="https://www.youtube.com/watch?v=0juOdNXHU6g" target="_blank" rel="external">complete 7:16:03 version</a> was done and made fully available. Meanwhile, my archive is still being processed after 24 hours, and only the last 1:35:01 is available at the moment; the total length shown in Video Manager also dropped from ~7:17 to 5:50:31 for whatever reason. (As for why mine is still being processed, I suppose YouTube priotizes popular streams.) In short, my backup was unnecessary and a disaster.</p>
<p>But my livestream went further than a backup. I didn’t expect to hit the top in Search, which attracted 5–10% of the total viewership. My stream peaked at ~400 concurrent viewers, compared to maybe ~6000 (or ~8000?) on the official stream. Also, the chatroom was sort of overtaken by Vietnamese fans — unfortunately I didn’t have the slightest clue of what they were talking about; I guess someone shared a link to my stream among them? Anyway, despite my effort to move people over to the official stream, especially after my stream started falling apart (which will be discussed in detail later), some people still stayed and I ended up with &gt;100 at the lowest point.</p>
<p>Time to put on technical gear. Duplicating a YouTube stream is trivial with FFmpeg. A basic one-liner is</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i <span class="string">"<span class="variable">$(youtube-dl -f 96 https://www.youtube.com/user/ChinaSNH48/live)</span>"</span> -bsf:a aac_adtstoasc -c copy -f flv rtmp://a.rtmp.youtube.com/live2/xxxx-xxxx-xxxx-xxxx</div></pre></td></tr></table></figure>
<p>where 96 is the format code for 1080p HLS, and <code>xxxx-xxxx-xxxx-xxxx</code> is the secret key available from either the <a href="https://www.youtube.com/live_dashboard" target="_blank" rel="external">Live Dashboard</a> or ingestion settings for an event with its separate stream.</p>
<p>Realistically, though, I needed to keep a local copy, and I was prepared to restart the job as quickly as possible in case the process died or had to be killed for whatever reason, so here’s the script I used in production:</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env zsh</span></div><div class="line"></div><div class="line"><span class="comment"># Source</span></div><div class="line">channel=https://www.youtube.com/user/ChinaSNH48/live</div><div class="line">format=96  <span class="comment"># 1080p HLS stream</span></div><div class="line"></div><div class="line"><span class="comment"># Destination</span></div><div class="line">endpoint=rtmp://a.rtmp.youtube.com/live2</div><div class="line">key=xxxx-xxxx-xxxx-xxxx  <span class="comment"># Actual key redacted</span></div><div class="line"></div><div class="line">title=<span class="string">'20170729 “我心翱翔”SNH48 Group第四届偶像年度人气总决选演唱会'</span></div><div class="line"></div><div class="line"><span class="comment"># Fetch stream URL</span></div><div class="line">urlfile=/tmp/stream_url  <span class="comment"># Persist stream URL in between sessions, in case the script needs to be restarted</span></div><div class="line">poll_interval=10  <span class="comment"># Interval for polling the live stream when waiting for the stream to begin</span></div><div class="line">stream=</div><div class="line"><span class="keyword">while</span> [[ -z <span class="variable">$stream</span> ]]; <span class="keyword">do</span></div><div class="line">    <span class="keyword">if</span> [[ -f <span class="variable">$urlfile</span> ]]; <span class="keyword">then</span></div><div class="line">        stream=<span class="string">"<span class="variable">$(&lt;$urlfile)</span>"</span></div><div class="line">        [[ -z <span class="variable">$stream</span> ]] &amp;&amp; rm <span class="variable">$urlfile</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        stream=<span class="string">"<span class="variable">$(youtube-dl -g -f $format $channel)</span>"</span></div><div class="line">        [[ -n <span class="variable">$stream</span> ]] &amp;&amp; <span class="built_in">echo</span> -n <span class="variable">$stream</span> &gt;<span class="variable">$urlfile</span> || sleep <span class="variable">$poll_interval</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line"><span class="keyword">done</span></div><div class="line"></div><div class="line"><span class="comment"># Stream to YouTube while keeping a local copy</span></div><div class="line">index=0</div><div class="line"><span class="keyword">while</span> :; <span class="keyword">do</span></div><div class="line">    <span class="comment"># Do not overwrite any saved segment</span></div><div class="line">    <span class="keyword">while</span> :; <span class="keyword">do</span></div><div class="line">        file=<span class="string">"<span class="variable">$title</span> <span class="variable">$index</span>.ts"</span></div><div class="line">        <span class="keyword">if</span> [[ -f <span class="variable">$file</span> ]]; <span class="keyword">then</span></div><div class="line">            (( index++ ))</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">break</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">    ffmpeg -re -i <span class="variable">$stream</span> -bsf:a aac_adtstoasc -c copy -f flv <span class="variable">$endpoint</span>/<span class="variable">$key</span> -c copy <span class="variable">$file</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>
<p>All went well for about five hours.<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> The latency was below ten seconds. Then the official stream was interrupted for at most a few seconds, and all hell broke loose. The download seems to have picked up just fine, with FFmpeg showing a healthy speed of 1x; I’m not sure if that speed is instantaneous or average — I always thought it’s instantaneous, but when I experienced a similar interruption during the test stream a day earlier (the July 28 warm-up event), the speed gradually climbed from ~0.8x back up to 1x over the course of twenty minutes or so, so the speed may be more complex than just instantaneous, although it doesn’t seem to be a global average as well. I would read the relevant parts of FFmpeg source code if I were really curious. Anyway, whatever that speed means, the RTMP stream simply fell apart. The status on the Live Dashboard begins to cycle through a gray “offline — stream complete”, a red “live — video output low” (technically <a href="https://developers.google.com/youtube/v3/live/docs/liveStreams/health_status_messages" target="_blank" rel="external"><code>videoIngestionStarved</code></a>), and the occasional yellow or green that couldn’t be maintained for more than a couple seconds. Reflected on the served stream, it was buffering all the time. I have no idea why a gap of few seconds could be so disruptive, considering network I/O isn’t remotely at capacity — I would imagine it should be easy to catch up. I would occasionally see a “last message repeated 1 times” message in FFmpeg’s output, but I never saw the actual messages…<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> Maybe the messages were about dropped segments from M3U8 playlists? If that’s the case, and given I/O shouldn’t be a bottleneck, I would guess it’s <code>-re</code>'s fault. <code>-re</code> is an input option for reading input at native frame rate; it’s necessary for streaming an archived stream (the first thing I tested), but I doubt its necessity when streaming another livestream — after all, the input can only be read at the native framerate, give or take a little. Whether dropping <code>-re</code> would be stability issues is something to investigate, but there’s a non-zero chance this could explain why FFmpeg just couldn’t catch up after the interruption.</p>
<p>The stream chugged along in the painful cycle for the better part of an hour. Then out of nowhere (segments were still being uploaded normally; I was monitoring my I/O) it got so bad that after three rounds of stopping and buffering the stream did not advance a single bit. I knew it was time to kill the process and accept defeat for my offline recording which was tied to the same process (a restart would apparently cause a short gap in the on-disk version). Somewhat ironically yet predictably, the stream went back to normal immediately. I should have made the hard decision much earlier.</p>
<p>The drama did not end there. YouTube actually expires their HLS feed URL after six hours. Therefore, after my stream went back to normal and my attention shifted back to the official stream (for the results, apparently), at some point FFmpeg just quitted with 403, and went on to fail in an infinite loop (see my script). The Live Dashboard was on my secondary machine by the side and I was only glancing at it from time to time, so I didn’t notice it until maybe twenty seconds later. I removed the expired <code>/tmp/stream_url</code> and kicked off the script again. In hindsight this seemed inevitable for a 7+ hour livestream,<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> but at least the gap could have been shortened if (1) I was refreshing the cached stream URL, say, every hour in the background; (2) I stayed vigilant by issuing a notification whenever <code>ffmpeg</code> quits.</p>
<p>That’s pretty much it. To summarize, here are the lessons I learned:</p>
<ul>
<li>The <code>-re</code> flag should probably be dropped (make sure to test the output stability before the next production run);</li>
<li>Decouple offline recording from streaming for flexibility. My bandwidth is more than enough to handle two simultaneous downloads;<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></li>
<li>Be decisive. If the stream can’t keep up, immediately kill and restart the transmission.</li>
<li>Refresh the cached stream URL every hour in the background so that we don’t scramble to fetch a new URL when the six hour expiration mark is hit;</li>
<li>Issue a notification with e.g. <code>terminal-notifier</code> whenever <code>ffmpeg</code> quits.</li>
</ul>
<p>By the way, as a side effect, the channel’s number of subscribers saw crazy growth on July 29:</p>
<p><img src="/img/20170731-subscribers-growth.svg" alt="Growth in number of subscribers."></p>
<p>I’m currently entertaining the idea of livestreaming Theater performances from <a href="http://live.bilibili.com/48" target="_blank" rel="external">live.bilibili.com/48</a> too, in the future. If I want to do that though, I need to make sure it works completely unattended.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Time and durations are all approximate. I did not keep timestamped logs, and have since removed the botched local copy; in addition, analytics for the livestream isn’t available yet. <a href="#fnref1" class="footnote-backref">↩</a></p>
</li>
<li id="fn2" class="footnote-item"><p>I suppose either the messages didn’t end in a newline, or there was an output race condition. <a href="#fnref2" class="footnote-backref">↩</a></p>
</li>
<li id="fn3" class="footnote-item"><p>I don’t know a way to feed another input URL, unbeknownst to me in the beginning, to a running <code>ffmpeg</code> process. Maybe there’s a way with <code>ffserver</code>? No idea since I never touched <code>ffserver</code>. <a href="#fnref3" class="footnote-backref">↩</a></p>
</li>
<li id="fn4" class="footnote-item"><p>There might be a small cost in terms of latency. <a href="#fnref4" class="footnote-backref">↩</a></p>
</li>
</ol>
</section>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/07/16/youtube-upload-progress-bar/">Command line YouTube upload with progress bar</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 16, 2017
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>The first technical post.</p>
<p>I upload videos to the channel using an adapted version of <a href="https://github.com/youtube/api-samples/blob/master/python/upload_video.py" target="_blank" rel="external"><code>upload_video.py</code></a> from YouTube’s API code samples. The script does not provide a progress bar. This is usually not a problem because my connection is pretty fast, and when I upload from my Mac I can always bring up Activity Monitor to check bytes uploaded by the python process. However, when I upload from a shared remote server, sometimes due to spikes in load not under my control, upload would seem slower than usual; so I do want to see a progress bar occasonally.</p>
<p><code>upload_video.py</code> uses <a href="https://google.github.io/google-api-python-client/docs/epy/googleapiclient.http.MediaFileUpload-class.html" target="_blank" rel="external"><code>MediaFileUpload</code></a> which is a blackbox taking only the file path, and when you call <a href="https://google.github.io/google-api-python-client/docs/epy/googleapiclient.http.HttpRequest-class.html#next_chunk" target="_blank" rel="external"><code>next_chunk</code></a> on an insert request, technically a <a href="https://google.github.io/google-api-python-client/docs/epy/googleapiclient.http.MediaUploadProgress-class.html" target="_blank" rel="external"><code>MediaUploadProgress</code></a> is returned which tells you the percentage completed, but realistically if you’re streaming the file (you should), the whole file is treated as a single “chunk” (<code>next_chunk</code> is only called once), so it’s pretty much useless.</p>
<p>I looked through the docs and, fortunately, there is a lower level <a href="https://google.github.io/google-api-python-client/docs/epy/googleapiclient.http.MediaIoBaseUpload-class.html" target="_blank" rel="external"><code>MediaIoBaseUpload</code></a> class that is less of a blackbox. With this class we can simply hook progress bar callbacks into <code>read</code> and <code>seek</code> of an <code>io.IOBase</code> object. Here’s some skeleton code (where I use an <code>io.BufferedReader</code> wrapped around an <code>io.FileIO</code> object, just like what is done by <a href="https://github.com/python/cpython/blob/v3.6.1/Lib/_pyio.py#L40-L249" target="_blank" rel="external"><code>open</code></a>):</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> io</div><div class="line"><span class="keyword">import</span> mimetypes</div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileReaderWithProgressBar</span><span class="params">(io.BufferedReader)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, file)</span>:</span></div><div class="line">        raw = io.FileIO(file)</div><div class="line">        buffering = io.DEFAULT_BUFFER_SIZE</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            block_size = os.fstat(raw.fileno()).st_blksize</div><div class="line">        <span class="keyword">except</span> (OSError, AttributeError):</div><div class="line">            <span class="keyword">pass</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">if</span> block_size &gt; <span class="number">1</span>:</div><div class="line">                buffering = block_size</div><div class="line">        super().__init__(raw, buffering)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">seek</span><span class="params">(self, pos, whence=<span class="number">0</span>)</span>:</span></div><div class="line">        abspos = super().seek(pos, whence)</div><div class="line">        <span class="comment"># <span class="doctag">TODO:</span> report position: abspos</span></div><div class="line">        <span class="keyword">return</span> abspos</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(self, size=<span class="number">-1</span>)</span>:</span></div><div class="line">        result = super().read(size)</div><div class="line">        <span class="comment"># <span class="doctag">TODO:</span> report position: self.tell()</span></div><div class="line">        <span class="keyword">return</span> result</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MediaFileUploadWithProgressBar</span><span class="params">(googleapiclient.http.MediaIoBaseUpload)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, file, mimetype=None, chunksize=googleapiclient.http.DEFAULT_CHUNK_SIZE,</span></span></div><div class="line">                 resumable=False):</div><div class="line">        fp = FileReaderWithProgressBar(file)</div><div class="line">        <span class="keyword">if</span> mimetype <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            mimetype, _ = mimetypes.guess_type(file)</div><div class="line">        super().__init__(fp, mimetype, chunksize=chunksize, resumable=resumable)</div></pre></td></tr></table></figure>
<p>Any progress bar class can be hooked into <code>FileReaderWithProgressBar</code>, with the update method called at places marked as <code>TODO</code>.</p>
<p>See my <a href="https://github.com/SNH48Live/SNH48Live/blob/master/bin/upload" target="_blank" rel="external"><code>upload</code></a> script for a complete implementation (commit <a href="https://github.com/SNH48Live/SNH48Live/blob/111c2002ff314e1566baedec90430ef2025bbded/bin/upload#L86" target="_blank" rel="external"><code>111c200</code></a> in case the file is moved or refactored in the future).</p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/07/15/1000-subscribers/">1000 subscribers</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 15, 2017
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>I’m thrilled to announce that, as of 11:20 EDT, July 15, 2017, the <a href="https://youtube.com/SNH48Live" target="_blank" rel="external">SNH48 Live</a> channel has accumulated one thousand subscribers. A pretty significant milestone. 1000 subscribers and 108k+ views in 115 days.</p>
<p>Also, the channel now shows up on the first page when you search for SNH48 on YouTube:</p>
<p><img src="/img/20170715-yt-search.png" alt="My video on the first page of search results for “SNH48”."></p>
<p>The channel is listed under popular channels within <a href="https://www.youtube.com/channel/UClOvU4q0xoLZ-bU-lW5fiWw" target="_blank" rel="external">the SNH48 topic</a> as well:</p>
<p><img src="/img/20170715-yt-topic.png" alt="My channel among “Popular Channels” within the SNH48 topic."></p>
<p>The full page screenshots are <a href="https://i.imgur.com/13rBbf9.jpg" target="_blank" rel="external">here</a> and <a href="https://i.imgur.com/I9LX6xG.jpg" target="_blank" rel="external">here</a>.</p>
<p>Of course, the channel’s influence is still miniscule compared to some of the other channels listed in the screenshot above, and I’ll probably never reach the same level of success, since Theater performances simply do not attract the same amount of attention as major television appearances — not even close actually, and my three-hour long VODs simply can’t compete with short videos in terms of average percentaged viewed — an important metric in YouTube’s ranking algorithms. However, I’m quite happy with where I am four months later. I’ll continue striving to be as consistent and professional as possible, and apparently it does pay off.</p>
<p>I want to thank everyone who supported the channel, and hopefully I’ll be motivated enough to see it through to 2k and beyond.</p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/07/14/莫寒四选拉票会文字版/">莫寒四选拉票会文字版</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 14, 2017
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>莫寒是将才，是S队的中流砥柱（之一），是全团最让我安心的存在。七月十二日，她用行云流水、铿锵有力、酣畅淋漓的十五分钟再次向我们展示了那个隐藏在可爱傲娇受小莫寒深处的，倔强而令人敬畏的灵魂。</p>
<p>点评都是多余的，我只想把她说的话原原本本地记录下来。视频版请点<a href="https://youtu.be/qkScOEaJQr0?t=2h38m7s" target="_blank" rel="external">这里</a>。</p>
<hr>
<blockquote>
<p>大家好，我是SNH48 Team SⅡ的莫寒。终于到拉票会了，其实当时抽到拉票会的瞬间真的很绝望，因为我觉得我自己要说的都已经说得差不多了，不如就把我的总选宣言循环播放十遍。但是后来发现，大家都是容易心软的人，我再不多说点什么，很害怕你们就被拐走了。所以现在想着以前说“没事啊你们可以去浪啊去开心”的我简直就是个傻子，为什么没有直白一点地说，“我只想你们看着我”呢。</p>
<p>拉票会前期有人来给我留言，说莫莫你拉票会务必好好表现，来弥补什么什么的。我不知道他为什么这么说，但好像觉得我很厉害一样。可是我很无力呀，能仰仗什么呢？感觉前面的差距都不是几千票，而是以万为单位的，就此刻渺小地站在这里的我全力去做了，可能也不存在什么力挽狂澜。我家算是很耿直很心软的吧，中报也特别实诚地all in（笑），得到了第七名。在外人看来可能觉得okay啊，不是达到目标了吗，但是我们自己很清楚啊，还有很多隐藏实力、虎视眈眈，准备在最后一鸣惊人的人。剩下十七天的我，真的太危险了。而且曾经中报都是第五，这次明明票数有所提高，却反而第七，真的特别没有底。我知道大家都很拼很辛苦了，但是如果不能守住现在的一切，就白拼了啊。都付出那么多了，不管过程多绚烂，对于总决选来说，十七天后的结果才是最重要的不是吗？</p>
<p>上一期莫莫有闻有说到面试的事。其实现在来说大多数也是一个形式吧。我是有很现实地想过一些问题的，某些原因说白了其实就是我自我价值不够，处于一个很尴尬的位置。可能公司觉得我的价值在这一层，但外界看来同一层他们能找到更好的人，而低一层的人又更低价，人家又不傻。当然不同层次得到的机会是不一样的，都到了这个高度，怎么甘心去掉落呢。所以需要让大家看到我有这个价值，想让别人知道我可以带来价值。外界的人不会主动来了解你，大概都是公司推荐吧，当然推荐的洗好我也不占便宜。最直观能让外界知道的就是总决选的排名，越往前自然也就越有优势，证明你越有价值。都已经到了这一步，当然要更往前冲啊。有机会去捍卫的东西，在一开始就不能够作出一丁点的让步。</p>
<p>我现在感觉自己变得越来越孤僻了。我是需要从成绩里去获得信心的人，但是现在说句什么都好像是在嘲讽自己的无力。别人在准备下一部戏，别人在筹备下一张EP，别人在等下一个综艺，那我呢，我在干什么（笑）？我好想就只能笑着，然后拼命地捂住耳朵说：我不要知道，我不想知道，但是为什么不是我呢。可是还是得笑着啊，因为我觉得不应该给你们传递这种消极的能量，所以我开直播大都是吐槽啊，吃播啊，嘻嘻哈哈的；如果真的直播给你们哭诉的话，我可能会是第一个崩坏掉的吧。得自己把这些情绪都排解掉，因为在大家面前就会变得脆弱，只有自己的时候，才不得不一个人坚强。但是后来发现，展示脆弱好像更容易得到同情。我现在需要这一份关心，需要这一份支持。你们也多看看我，其实我一点都不好。</p>
<p>（嗯）人一旦空闲起来就很容易想很多，经常做噩梦啊，有可能就是大半夜地惊醒，然后很难过。感觉应该去看看医生，但是觉得光是要给医生解释我所处的境地就很困难，万一他还不能理解，只会让自己更加抑郁吧。做娜娜那集莫莫有闻的那天，一大早来剧场排新公演，然后收到妈妈的信息，说家里有点事（哽咽）。瞬间就很恍惚，但是还是有排练啊，有直播啊，一切都得正常运转不是吗。所以我很正常。下午的时候对完了直播的流程再回来排练，就感觉整个人像僵尸一样，大家在旁边说话都像是天外传来的声音，再多戳我一下我就要爆炸了。所以排到中途其实我就自己下楼了，得跳脱出来冷静。不可以哭。嗯，还有要做的事情。直播完莫莫有闻回去，十点，给我妈打电话，结果发现她手机关机。天知道那个时候我有多害怕。抖着给我爸打电话，才知道我妈是去北京学习，然后现在赶回家，在飞机上，所以关机了。我说，那我明天回来吧。我爸说你别回来了，你们不是马上就要新公演了吗，回来也帮不上什么忙（哽咽，流泪），你就自己忙自己的事情。然后我挂了电话，就抽了自己一巴掌。</p>
<p>第二天呢，继续去剧场排练。无尽的世界当中不是有一段大家都走掉了，就剩我一个人在台上的地方吗。那个时候说这里的意义是我代表着一种信念。和演出的时候不一样，演出台下是有人的啊，但是彩排的时候就没有了。就真的大家都走掉了。一个一个的。台下也是空荡荡的。就剩你一个人坐在那里。灯光黄黄的一点都不刺眼，但是却好像一点一点地把我吞噬，让我沦陷。我那个时候坐在那边低着头，特别特别难过，就是，啊，看吧，又剩你了。大家都走掉了就剩你了吧。一个人什么玩意儿呢。好想消失啊。去你的什么信念。今天失去的东西有什么意义吗？为什么不在还在的时候就好好去珍惜呢？重要的你喜欢的不就应该现在去支持吗？但所有的一切都是一瞬间，抬头的时候就又要笑着啊。没有关系的。</p>
<p>当一切都完成之后，就觉得自己很可怕。害怕被大家发现我是这么可怕的人，是这种一点都不厉害，特别软弱的人。感觉自己像一只猫，因为听说猫咪在要死掉之前，就会默默地离开，找一个隐蔽之处，然后静悄悄地死掉。可是我不想死掉。我一点都不想。</p>
<p>在蛮长时间的空窗期之后终于等来了我的莫莫有闻。我真的非常地感谢帮我策划这档节目的所有的staff，没有让我被剩在中心，赐予了我这一份工作。其实在节目出来之前，都不大被人看好吧。可对我来说是唯一的所以重要的，因而我自己亲身参与了策划，坚持每一期的内容都经我手，直播的流程也都提前自己写，很真心实意地去做，终于也让这个节目得到了大家的认可。有人说，莫寒这个节目很好，但是对她没什么用，不吸粉，还容易让自己的粉丝分票（笑）。这我知道啊，我也很害怕啊，但是我更希望透过这个，可以让更多的人看到，莫寒的特别，莫寒是不可或缺的，莫寒有她必要存在的意义。还有人说谁能把莫寒聊哭吗，我觉得很难吧（笑）。对我来说，看着她们，我是一个过来人，我经历过，所以我能够理解。而正是因为我经历的都过去了，所以我很少再去提及。但是我从未一帆风顺过，直到现在也充满坎坷。我也需要去被珍惜，我也想要被拯救。</p>
<p>所以我真的很羡慕啊，如果不用投也能有很好的资源，那我不用太在意总决选的，还不如大家平时多做点应援，最多就是争口气嘛。但我没有这种运气。我只能靠自己、只能靠你们。一直一直都是这么过来的，都已经拿到的怎么可以再拱手让人。一直被别人嘲笑不给力，为什么不反击？为什么呢？现在不就是应激的反击的时候吗？用最后的成绩去让别人闭嘴就好啦。有成绩才有底气去要求、才有底气去冲击啊。我最害怕的事情就是今年结束了之后：看吧，你们都是垃圾，什么都不给你就是正确的啊。呵，仿佛从一开始就变得毫无疑问，就是如此了。</p>
<p>看了中报，甚至连我都觉得，可能最后要被屠榜了。真的特别的厉害。但是现在还没有啊。我不想、不希望、不愿意，我就是想要挤进去，明明就有的可能性怎么能够让它溜掉呢？即使知道很难，但是不管结局，毅然决然地发起冲击，不就是偶像为了梦想该拥有的勇气吗？所以我需要每一个人的帮助，需要每一个人的支持，每一个人。结局还未定，而且正在由你和我共同地书写，如果已经到最后了就改变不了任何事情了。但是现在还没有到最后呢。我们还有时间，我们还可以去冲，那么就可以改变一切的。有你，有我，有我们每一个人。</p>
<p>请给莫寒投票吧。真的，她真的很需要你们的帮助，很需要你们的支持（音乐起）。我真的，很需要你们的拯救。</p>
<p>(演讲终)</p>
</blockquote>
<p>附演唱部分，翻唱林俊杰、五月天《黑暗骑士》：</p>
<blockquote>
<p>黑暗里谁还不睡　黑色的心情和斗篷假面<br>
黑夜的黑不是最黑　而在于贪婪找不到底线</p>
<p>脚下是卑微的街　我孤独站在城市天际线<br>
别问我恶类或善类　我只是渴望飞的哺乳类</p>
<p>善恶的分界　不是对立面<br>
而是每个人　那最后纯洁的防线　都逃不过考验</p>
<p>有没有一种考验　有没有一次淬炼<br>
拯救了世界就像　英雄　电影　情节<br>
有没有一种信念　有没有一句誓言<br>
呼唤黎明的出现　yeah yeah~ yeah yeah~<br>
呼唤黎明的出现　yeah yeah~ yeah yeah~<br>
呼唤黎明的出现</p>
<p>越来越大的企业　越来越小的公园<br>
越来越深的幻灭　英雄　电影　情节<br>
面具下的人是谁　或者说不管是谁　wow~<br>
都无法全身而退　yeah yeah~ yeah yeah~<br>
都无法全身而退　yeah yeah~ yeah yeah~<br>
都无法全身而退</p>
<p>（转身，背对观众）</p>
<p>泪水洗去铅华雨露<br>
试图冲击独大局面<br>
尚存坚定前进信念<br>
你们的光点聚成英雄的支点<sup>＊</sup></p>
<p>（转身，面对观众）</p>
<p>当我们都走上街　当我们怀抱信念<br>
当我们亲身扮演　英雄　电影　情节<br>
你就是一种信念　你就是一句誓言　wow~<br>
世界正等你出现　yeah yeah~ yeah yeah~<br>
世界正等你出现　yeah yeah~ yeah yeah~</p>
<p>我正在等你出现<br>
来拯救我</p>
</blockquote>
<p><small><sup>＊</sup>这段是莫寒口述的原创部分，有几个词听得不是很清楚，记录可能有误。</small></p>
<hr>
<p>莫寒，<a href="http://weibo.com/3053424305/Fc5TGk8xC" target="_blank" rel="external">2017年7月12日23时11分</a>于微博：</p>
<blockquote>
<p>我正在等你出现，<br>
来拯救我。</p>
</blockquote>
<p><img src="/img/20170712-%E8%8E%AB%E5%AF%92%E5%BE%AE%E5%8D%9A.jpg" alt=""></p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/07/11/hello-world/">Hello, world!</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 11, 2017
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>This is the mandatory hello world post.</p>
<p>So, why am I starting a blog for <a href="https://snh48live.org" target="_blank" rel="external">snh48live.org</a>? The channel has been up for 113 days since its inception on March 22, 2017, and it now boasts 970 subscribers and 100k+ views. Quite an achievement, and I’m really excited about it. I figured I need a place to record some of the milestones, interesting finds (I’ve never run a YouTube channel seriously prior to this, so I learn new things every once in a while), thoughts and stuff; and since short-form writing has never been my greatest strength, Twitter is not the right platform for this. Hence a blog. Mostly for myself.</p>
<p>I’m not exactly sure what I’m going to write about, other than for the first two or three posts, this one included. The blog may even become dormant after the first week; I just don’t know. Another thing I’m not sure about is the language of this blog. I’ll probably use whatever language I’m most comfortable with on a given topic, which means English for technical stuff, Chinese when I need to speak a lot of proper nouns (girls, performances, etc.), and so on.</p>
<p>I’m choosing <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a> as the generator for this blog, and am using the <a href="http://www.ahonn.me/hexo-theme-even/" target="_blank" rel="external">Even</a> theme as a basis. Hopefully I’ll like Hexo better than Jekyll, which isn’t a high bar to clear.</p>

        
      
    </div>

    

    

  </article>

    
  </section>

  
  <nav class="pagination">
    
    
  </nav>


          </div>
          

        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:snh48live@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
        
          <a href="https://twitter.com/snh48live" class="iconfont icon-twitter" title="twitter"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/snh48live" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a href="https://snh48live.tumblr.com" class="iconfont icon-tumblr" title="tumblr"></a>
        
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>

  ·

  <span class="theme-info">
    Theme
    <a class="theme-link" href="https://github.com/SNH48Live/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy;
    
    2017

    <span class="author">
      <a class="theme-link" href="https://snh48live.org/">SNH48 Live</a>
    </span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.4.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.4.x"></script>

    
  </body>
</html>
